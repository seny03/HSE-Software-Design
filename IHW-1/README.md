# Отчет по контрольной работе №1

### Основная функциональность:
- Работа с доменной моделью: создание, редактирование и удаление счетов, категорий, операций (доходов/расходов).

### Дополнительная функциональность:
1. **Аналитика**:
   - Подсчет разницы доходов и расходов за выбранный период
   - Группировка доходов и расходов по категориям

2. **Импорт и экспорт данных**:
   - Экспорт всех данных в файлы CSV, YAML, JSON
   - Импорт данных из этих форматов

3. **Статистика**:
   - Измерение времени работы отдельных пользовательских сценариев

## Принципы SOLID и GRASP

### Single Responsibility Principle (SRP)
- **Классы доменной модели** (`BankAccount`, `Category`, `Operation`) отвечают только за хранение данных.
- **Сервисы** (`AccountService`, `CategoryService`, `OperationService`) отвечают за операции над соответствующими доменными объектами.
- **Команды** (`AddAccountCommand`, `ReportBalanceCommand`, `ImportDataCommand`) отвечают за выполнение конкретных пользовательских сценариев.
- **Импортеры/Экспортеры** отвечают только за преобразование данных в различные форматы.

### Open/Closed Principle (OCP)
- **Интерфейс `ICommand`** позволяет добавлять новые команды без изменения существующего кода.
- **Интерфейс `IRepository`** позволяет добавлять новые реализации хранилищ без изменения сервисов.
- **Интерфейс `IExportVisitor`** позволяет добавлять новые форматы экспорта без изменения существующего кода.
- **Абстрактный класс `ImporterBase`** позволяет добавлять новые форматы импорта без изменения существующего кода.

### Liskov Substitution Principle (LSP)
- Все реализации `IRepository<T>` могут быть заменены друг на друга без изменения поведения программы.
- Все реализации `ICommand` могут быть заменены друг на друга без изменения поведения программы.
- Все реализации `IExportVisitor` могут быть заменены друг на друга без изменения поведения программы.

### Interface Segregation Principle (ISP)
- Интерфейс `ICommand` содержит только один метод `ExecuteAsync()`, что делает его минимальным и специализированным.
- Интерфейс `IRepository<T>` содержит только необходимые методы для работы с хранилищем.

### Dependency Inversion Principle (DIP)
- Сервисы зависят от абстракции `IRepository<T>`, а не от конкретной реализации.
- Команды зависят от абстракций (сервисов, интерфейсов), а не от конкретных реализаций.
- Использование DI-контейнера для внедрения зависимостей.

### High Cohesion (GRASP)
- Классы имеют высокую связность, каждый класс отвечает за конкретную функциональность.
- Сервисы объединяют логически связанные операции над доменными объектами.
- Команды инкапсулируют конкретные пользовательские сценарии.

### Low Coupling (GRASP)
- Использование интерфейсов и абстрактных классов для уменьшения связанности между компонентами.
- Использование DI для внедрения зависимостей, что уменьшает связанность между компонентами.
- Сервисы не зависят от конкретных реализаций хранилищ.

## Паттерны GoF

### Порождающие паттерны

#### Dependency Injection
- Реализован с помощью Microsoft.Extensions.DependencyInjection.
- Используется для внедрения зависимостей в сервисы и команды.
- Позволяет легко заменять реализации компонентов без изменения кода.
- Реализован в `Program.cs` при настройке сервисов.

### Структурные паттерны

#### Декоратор (Decorator)
- Реализован в классе `TimingDecorator`.
- Позволяет добавлять функциональность измерения времени выполнения к любой команде.
- Обертывает команду и добавляет измерение времени выполнения.
- Важность: позволяет добавлять функциональность без изменения существующего кода.

#### Фасад (Facade)
- Реализован в сервисах `AccountService`, `CategoryService`, `OperationService`.
- Предоставляет простой интерфейс для работы с доменными объектами.
- Скрывает сложность работы с хранилищем и бизнес-логикой.
- Важность: упрощает использование системы, предоставляя единую точку входа для работы с доменными объектами.

### Поведенческие паттерны

#### Команда (Command)
- Реализован через интерфейс `ICommand` и его реализации (`AddAccountCommand`, `ReportBalanceCommand`, `ImportDataCommand`, `ExportDataCommand` и др.).
- Инкапсулирует запрос как объект, позволяя параметризовать клиентов с различными запросами.
- Важность: позволяет отделить запрос от его выполнения, что упрощает добавление новых команд и их комбинирование.

#### Шаблонный метод (Template Method)
- Реализован в абстрактном классе `ImporterBase` и его наследниках (`JsonImporter`, `CsvImporter`, `YamlImporter`).
- Определяет скелет алгоритма, позволяя подклассам переопределить некоторые шаги алгоритма без изменения его структуры.
- Важность: позволяет избежать дублирования кода при реализации схожих алгоритмов.

#### Посетитель (Visitor)
- Реализован через интерфейс `IExportVisitor` и его реализации (`JsonExportVisitor`, `CsvExportVisitor`, `YamlExportVisitor`).
- Позволяет добавлять новые операции к объектам без изменения их классов.
- Важность: позволяет добавлять новые форматы экспорта без изменения доменных классов.

## Инструкция по запуску

```bash
cd FinancialAccounting
dotnet run
```

### Доступные команды:

- `add-account <name> <balance>` - Добавить новый счет
- `edit-account <old_name> <new_name> <balance>` - Редактировать существующий счет
- `delete-account <name>` - Удалить счет
- `add-category <name> <Income/Expense>` - Добавить новую категорию
- `edit-category <old_name> <new_name> <Income/Expense>` - Редактировать существующую категорию
- `delete-category <name>` - Удалить категорию
- `add-operation <Income/Expense> <account_name> <amount> <category_name> [description]` - Добавить новую операцию
- `edit-operation <Income/Expense> <account_name> <old_amount> <category_name> <new_type> <new_amount> [new_description]` - Редактировать существующую операцию
- `delete-operation <Income/Expense> <account_name> <amount> <category_name>` - Удалить операцию
- `report-balance <account_name> <start_date> <end_date>` - Получить отчет о балансе за период
- `report-category <account_name>` - Получить отчет о группировке операций по категориям
- `import <json/csv/yaml> <filename>` - Импортировать данные из файла
- `export <json/csv/yaml> <filename>` - Экспортировать данные в файл
- `time` - Включить измерение времени выполнения следующей команды
- `exit` - Выйти из приложения

## Тестовое покрытие

- Покрытие строк кода: 58.4%
- Если не учитывать Main.cs, то больше 65%
- Почти все классы имеют 100% покрытие
